{
    "sourceFile": "reactcog/reactcog.py",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1763403110903,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1763403110903,
            "name": "Commit-0",
            "content": "import discord\r\nfrom redbot.core import commands, Config\r\nfrom redbot.core.bot import Red\r\n\r\nclass ReactCog(commands.Cog):\r\n    \"\"\"\r\n    Simple reaction cog that adds reactions to messages.\r\n    Supports multiple reactions per message and persists across reloads.\r\n    \"\"\"\r\n\r\n    def __init__(self, bot: Red):\r\n        self.bot = bot\r\n        self.config = Config.get_conf(self, identifier=99283472934723)\r\n        self.config.register_global(messages={})\r\n\r\n    # ---------------------------------------------------\r\n    # Utilities\r\n    # ---------------------------------------------------\r\n    async def _apply_reactions(self):\r\n        \"\"\"Reapply all stored reactions on cog load.\"\"\"\r\n        data = await self.config.messages()\r\n        for msg_id, entry in data.items():\r\n            channel_id = entry[\"channel\"]\r\n            emojis = entry[\"emojis\"]\r\n\r\n            channel = self.bot.get_channel(channel_id)\r\n            if channel is None:\r\n                continue\r\n\r\n            try:\r\n                msg = await channel.fetch_message(int(msg_id))\r\n            except Exception:\r\n                continue\r\n\r\n            for e in emojis:\r\n                try:\r\n                    await msg.add_reaction(e)\r\n                except Exception:\r\n                    pass\r\n\r\n    @commands.Cog.listener()\r\n    async def on_ready(self):\r\n        # Reapply reactions after bot starts\r\n        await self._apply_reactions()\r\n\r\n    # ---------------------------------------------------\r\n    # Commands\r\n    # ---------------------------------------------------\r\n\r\n    @commands.group(name=\"react\", invoke_without_command=True)\r\n    @commands.is_owner()\r\n    async def react_group(self, ctx):\r\n        \"\"\"Base command for reaction controls.\"\"\"\r\n        await ctx.send(\"Use `.react add`, `.react remove`, `.react list`\")\r\n\r\n    @react_group.command(name=\"add\")\r\n    @commands.is_owner()\r\n    async def react_add(self, ctx, channel: discord.TextChannel, message_id: int, emoji: str):\r\n        \"\"\"\r\n        Add a reaction to a message.\r\n        Example: .react add #general 123456789012345678 üëç\r\n        \"\"\"\r\n        try:\r\n            msg = await channel.fetch_message(message_id)\r\n        except:\r\n            return await ctx.send(\"‚ùå Unable to fetch that message.\")\r\n\r\n        try:\r\n            await msg.add_reaction(emoji)\r\n        except:\r\n            return await ctx.send(\"‚ùå Could not add that reaction.\")\r\n\r\n        data = await self.config.messages()\r\n\r\n        if str(message_id) not in data:\r\n            data[str(message_id)] = {\"channel\": channel.id, \"emojis\": []}\r\n\r\n        if emoji not in data[str(message_id)][\"emojis\"]:\r\n            data[str(message_id)][\"emojis\"].append(emoji)\r\n\r\n        await self.config.messages.set(data)\r\n\r\n        await ctx.send(f\"‚úÖ Reaction `{emoji}` added to message `{message_id}`\")\r\n\r\n    @react_group.command(name=\"remove\")\r\n    @commands.is_owner()\r\n    async def react_remove(self, ctx, message_id: int, emoji: str):\r\n        \"\"\"\r\n        Remove a stored reaction from a message.\r\n        Example: .react remove 123456789012345678 üëç\r\n        \"\"\"\r\n        data = await self.config.messages()\r\n\r\n        if str(message_id) not in data:\r\n            return await ctx.send(\"‚ùå That message has no stored reactions.\")\r\n\r\n        if emoji not in data[str(message_id)][\"emojis\"]:\r\n            return await ctx.send(\"‚ùå That reaction is not stored for this message.\")\r\n\r\n        data[str(message_id)][\"emojis\"].remove(emoji)\r\n\r\n        if not data[str(message_id)][\"emojis\"]:\r\n            # If empty, remove the entry\r\n            del data[str(message_id)]\r\n\r\n        await self.config.messages.set(data)\r\n\r\n        await ctx.send(f\"üóë Removed reaction `{emoji}` from `{message_id}`\")\r\n\r\n    @react_group.command(name=\"list\")\r\n    @commands.is_owner()\r\n    async def react_list(self, ctx):\r\n        \"\"\"List all stored message reactions.\"\"\"\r\n        data = await self.config.messages()\r\n\r\n        if not data:\r\n            return await ctx.send(\"üì≠ No stored reactions.\")\r\n\r\n        lines = []\r\n        for msg_id, entry in data.items():\r\n            channel_id = entry[\"channel\"]\r\n            emojis = entry[\"emojis\"]\r\n            lines.append(f\"üìå **Message `{msg_id}` in <#{channel_id}>** ‚Üí {', '.join(emojis)}\")\r\n\r\n        await ctx.send(\"\\n\".join(lines))\r\n"
        }
    ]
}